# Solana Rust Program - Counter Example A beginner-friendly Solana program demonstrating core blockchain development concepts with Rust. ## What You'll Learn - Solana Programs: On-chain programs (smart contracts) in Rust - Account Model: How Solana stores and manages state - Instructions: Program entry points and data handling - Client Integration: TypeScript client for program interaction - Testing: Comprehensive testing with Solana Program Test - Deployment: Local and devnet deployment strategies ## Prerequisites - Rust (latest stable) - Node.js (v18+ recommended) - Solana CLI tools - Basic Rust knowledge helpful but not required ## Setup Instructions ### 1. Install Solana CLI Tools ```bash # Install Solana CLI sh -c "$(curl -sSfL https://release.solana.com/v1.17.0/install)" # Add to PATH export PATH="~/.local/share/solana/install/active_release/bin:$PATH" # Verify installation solana --version ``` ### 2. Configure Solana ```bash # Set to devnet for testing solana config set --url devnet # Generate keypair (or use existing) solana-keygen new --outfile ~/.config/solana/id.json # Check configuration solana config get ``` ### 3. Install Dependencies ```bash cd solana-rust npm install ``` ### 4. Build Program ```bash # Build the Rust program cargo build-bpf ``` ### 5. Run Tests ```bash # Run Rust tests cargo test # Run with output cargo test -- --nocapture ``` ### 6. Deploy Program #### Local Testing (Recommended for learning) ```bash # Terminal 1: Start local validator solana-test-validator --reset # Terminal 2: Deploy program solana program deploy target/deploy/simple_solana_program.so # Get program ID for client solana program show <program-id> ``` #### Devnet Deployment (Optional) ```bash # Request SOL for deployment (devnet) solana airdrop 2 # Deploy to devnet solana program deploy target/deploy/simple_solana_program.so --url devnet ``` ### 7. Run Client ```bash # Update client.ts with your program ID # Then run: npm run client ``` ## Project Structure ``` solana-rust/ src/ lib.rs # Main Solana program tests/ integration.rs # Program tests client.ts # TypeScript client Cargo.toml # Rust dependencies package.json # Node.js dependencies README.md # This file ``` ## Core Concepts Demonstrated ### 1. Account Model ```rust #[derive(BorshSerialize, BorshDeserialize, Debug)] pub struct CounterAccount { pub count: u64, // State data pub authority: Pubkey, // Access control } ``` ### 2. Instruction Processing ```rust pub fn process_instruction( program_id: &Pubkey, // Our program's address accounts: &[AccountInfo], // Accounts to operate on instruction_data: &[u8], // Instruction parameters ) -> ProgramResult ``` ### 3. Security & Validation ```rust // Authority verification if counter_data.authority != *authority.key { return Err(ProgramError::InvalidAccountData); } // Overflow protection counter_data.count = counter_data.count .checked_add(1) .ok_or(ProgramError::ArithmeticOverflow)?; ``` ## Testing Features Our test suite covers: - Counter initialization - Increment/decrement functionality - Authority validation - Security checks - Error handling - Integration testing with Solana runtime ## Key Solana Concepts ### Programs vs Smart Contracts - Solana "programs" = Ethereum "smart contracts" - Programs are stateless - state lives in accounts - One program can manage many accounts ### Account Model vs EVM - Ethereum: Contract stores its own state - Solana: Accounts store state, programs process instructions ### Rent & Ownership - Accounts must pay "rent" or be rent-exempt - Programs own accounts they create - Proper space allocation is crucial ### Instructions vs Transactions - One transaction can contain multiple instructions - Instructions are atomic within a transaction - Failed instruction = entire transaction fails ## Common Issues & Solutions ### Issue: "Program failed to complete" Solution: Check account ownership and size requirements ### Issue: "Insufficient lamports" Solution: Ensure accounts are rent-exempt or have sufficient balance ### Issue: "Invalid account data" Solution: Verify serialization/deserialization matches ### Issue: "Missing required signature" Solution: Ensure proper signer configuration in instructions ## Performance Benefits Solana Advantages: - 400ms block times (vs 12s Ethereum) - 65,000+ TPS theoretical throughput - $0.00025 average transaction fee - Parallel processing capability - Predictable fees (no gas wars) ## Next Steps 1. Add Features: Implement reset, multi-counter management 2. Advanced Patterns: Cross-program invocations (CPI) 3. Token Integration: Work with SPL tokens 4. Frontend: Build React frontend with Wallet adapters 5. Advanced Testing: Fuzzing, property-based testing ## Useful Resources - [Solana Documentation](https://docs.solana.com/) - [Anchor Framework](https://anchor-lang.com/) (Advanced Solana development) - [Solana Cookbook](https://solanacookbook.com/) - [Solana Program Library](https://spl.solana.com/) ## Job-Ready Skills Covered - Rust programming for blockchain - Solana program development - Account model understanding - Security-first development - Comprehensive testing - Client integration patterns - Deployment and DevOps